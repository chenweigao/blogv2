性能改进

Linux 6.6 在性能方面进行了多项优化，涵盖调度器、I/O 子系统和内存管理等。首先引入了全新的 EEVDF 调度器（Earliest Eligible Virtual Deadline First），替换了已有十余年的 CFS 调度器，通过为进程计算“虚拟截止时间”和滞后值，实现对延迟敏感任务的更快速调度，从而改善整体延迟表现。对于 I/O 子系统，增强了 io_uring 异步直接 I/O 性能，在测试中可带来高达 37% 的性能提升；同时改进了块层写入流程，支持对每个块使用独立的「脏状态」标记，减少写放大，并在缓冲写入路径中利用文件系统支持的更大页（folio）来提高吞吐。另外，对 unbound workqueue 的可配置性进行提升，使其更好地利用多核 CPU 的 L3 缓存结构，增强了并行任务的本地化性能。

在内存管理方面也有多项增强：例如对页表和内存故障处理进行优化，将某些文件后备页面故障移至轻量级的 folio 机制以提高效率；统一了巨页（hugetlb）与透明巨页（THP）的 gup (get_user_pages) 路径，加快了 THP 分配和释放过程；还引入了可选的 kmalloc 随机化（slab 缓存地址随机化）功能，用于抵御堆喷射攻击。这些改进结合起来，使得 Linux 6.6 在多核处理、快速 I/O 和内存访问等关键场景下有更好的性能表现。

全新调度器（EEVDF）：引入 Earliest Eligible Virtual Deadline First 调度算法，利用双参数（时间片权重与截止时间）重构调度逻辑，优先安排滞后较大的延迟敏感进程，改善任务响应延迟。

I/O 性能优化：改进 io_uring 异步直接 I/O，测试显示可提升约 37% 的写入吞吐；块层增加「每块脏页标记」支持，减少小文件系统块写入时的写放大效应；在文件系统顺序写入时优先创建更大页面（folio），提升缓冲写效率。

工作队列改进：unbound workqueue 的亲和性得到增强，可根据多 L3 缓存结构优化任务调度，使多核系统更高效地利用缓存资源。

内存管理增强：新增 kmalloc 随机化选项（硬化安全）；对透明巨页统一管理，提高 THP 分配/回收速度；推动文件系统使用 folio 结构处理内存页，以减少管理开销；以及支持多池（zpool）zswap，改善内存压缩交换性能。

文件系统更新

Linux 6.6 对主流文件系统进行了多项功能增强和性能优化：Ext4 文件系统增加了周期性超级块更新检查机制，增强了文件系统完整性；同时优化了延迟分配（delalloc）追加写入的路径，提高了顺序写性能。Btrfs 文件系统在创建子卷时能够继承父目录的权限和时间戳，完善了子卷的属性处理；弃用了过时的完整性校验（integrity checker）功能，并修复了之前重写后导致的刷写（scrub）性能下降问题。XFS 文件系统引入了在线修复（online fsck）框架的首批功能，允许在挂载状态下修复部分元数据或执行在线擦除检查，例如块回收和数据纠错等。

其他文件系统方面：F2FS（闪存文件系统）在本次更新中改进了对分区（zoned）块设备和压缩功能的支持，以适应新兴硬件需求。OverlayFS 文件系统增加了对底层只读层启用 fs-verity（文件级真实性校验）的支持，通过为元数据指定 overlay.verity xattr，可在覆盖层验证底层文件内容防篡改；同时优化了对文件 ID 的报告和调试检查。tmpfs（内存文件系统）新增了用户/组配额和直接 I/O 支持，并允许对目录使用稳定的偏移量以方便快照等操作。NFS 内核服务器方面，新增对 NFSv4.1 写委派（write delegations）的支持，使客户端能够更积极地缓存单个文件的数据和元数据，减少网络往返，NFSv4.2 还默认启用了 READ_PLUS 操作以提高随机读取效率。此外，原本在用户空间实现的 SMB3 文件共享（CIFS）功能，6.6 版将内核 KSMBD 功能提升为稳定版本，为 Linux 原生提供更高效、更安全的文件共享服务。

Ext4：周期性检查和更新超级块以防止元数据腐坏；优化延迟分配写入路径，加快大文件连续写入速度。

Btrfs：在创建子卷时复制父目录的权限和时间戳；废除旧的完整性校验子功能；修复了上游改动后导致的擦写（scrub）性能回归。

XFS：引入在线 fsck 修复（block reaping、元数据重建、实时区块摘要擦除等功能），实现了在挂载时对文件系统的部分修复能力。

F2FS：增强对分区存储设备（Zoned block devices）和数据压缩的支持，提升在新型 SSD 上的性能和可靠性。

OverlayFS：支持对底层只读层使用 fs-verity 验证；改进对文件 ID 的报告以及调试检查。

tmpfs：新增用户/组配额功能，支持对 tmpfs 文件进行直接 I/O 读取/写入，并提供稳定目录偏移量支持。

NFS：内核 NFS 服务器支持 NFSv4.1 写委派（write delegations），允许客户端更积极地缓存文件，减少网络延迟；默认启用 NFSv4.2 的 READ_PLUS 操作。

SMB（KSMBD）：将 SMB3 协议的内核实现（KSMBD）标记为稳定，使 Linux 内核具备高效的原生文件共享服务能力。

安全增强

6.6 版内核在安全方面也引入了多项重要改进，包括新硬件功能支持、内核随机化和访问控制机制更新等。Intel Shadow Stack（CET 控制流保护）终于合入主线，利用 CPU 硬件为调用堆栈分配不可修改的影子栈，有效抵御 ROP 攻击。对 RISC-V 平台增加了内核地址空间布局随机化（KASLR）和控制流完整性（KCFI）支持，并允许用户空间访问性能计数器，强化了新兴架构的安全性。为了防范内核堆喷射攻击，新增了 kmalloc 缓存随机化选项，使分配的内核对象地址更难预测。

内核安全模块（LSM）与访问控制方面，也有细节改进，例如在 SELinux 代码中移除了对美国 NSA 的引用（组织名称替换），以减少依赖历史遗留内容。针对用户空间，内核挂载接口增加了新标志，可禁止多个 mount 共享同一个超级块，增强了命名空间隔离。另外，对 BPF 安全 也进行了修复和更新，如增强了 netfilter (防火墙) 与 BPF 的兼容性处理，并移除不再需要的 BPF 事件支持，从而减少潜在的安全漏洞。此外还支持 Hyper-V 虚拟化环境下的 SEV-SNP 和 TDX 客户机，这些都是面向云和虚拟化环境的安全增强。

硬件安全：引入 Intel Shadow Stack（CET）支持，利用硬件保护堆栈不被恶意修改；RISC-V 架构新增 KASLR 和控制流完整性（KCFI）支持。

内核随机化与硬化：可选开启 kmalloc（内核堆缓存）地址随机化来抵御堆喷射攻击；LoongArch 平台新增对 KASAN、KCOV、KFENCE、KGDB 等内核调试工具的支持，提高针对该架构的调试和漏洞检测能力。

访问控制更新：SELinux 代码删除了对 NSA 组织的引用，AppArmor 等 LSM 模块继续改进；内核挂载 API 新增标志位，以禁止多个挂载共享同一超级块，从用户空间角度增强文件系统隔离。

BPF/网络安全：修复了与 netfilter、防火墙规则相关的 BPF 实现；添加了新的 BPF helper 和网络功能（见下节）同时去除旧的 BPF 事件支持，从而减少可攻击面。

其他：支持虚拟化安全特性，包括 Hyper-V 上的 SEV-SNP 和 TDX 客户机支持；LoongArch 架构下新增对 KASAN/KFENCE 等调试堆栈检测工具的支持，帮助开发者发现内核漏洞。

驱动支持

Linux 6.6 扩展了对各种硬件设备的支持，涵盖 GPU、网络和存储等领域。GPU 方面，AMD 驱动增加了对下一代 Zen5 平台的温度监控和纠错检测（EDAC）支持，并引入了 Dynamic Boost Control（动态加速）功能；新增对 FreeSync Panel Replay 的支持，为支持 FreeSync 显示器的笔记本提供了自适应刷新控制的替代方案。NVIDIA GPU 驱动（Nouveau 和闭源驱动）同样更新：Nouveau 增加了对 NVK Vulkan 驱动的新用户空间 API；闭源驱动方面，为 NVIDIA T4 数据中心 GPU 增加了 Secondary Bus Reset（次总线复位）支持，改进了 GPU 的复位稳定性。Intel 集成显卡方面，继续完善对 Meteor Lake 和即将发布的 Lunar Lake 平台的支持，包括新的显示控制器和 VPU4 等硬件功能。此外，其他图形子系统也合入了更多 DRM 持续集成（CI）代码，以提高驱动开发质量。

网络设备：增加了对新款以太网控制器的支持，包括多款基于 Mellanox/NVIDIA 硬件的网卡，以及新的设备树接口，增强了对不同 SoC 平台的网络引导和配置兼容性。同时引入了新的 IIO 传感器驱动和 Intel IVSC（管理引擎固件通信）驱动，使对现代服务器硬件的支持更完善。

存储控制器：6.6 版支持更多新的存储设备和功能。例如 ublk 用户态块设备驱动现在支持分区（Zoned）存储，便于新型 SMR/HDD 设备的使用。对 USB 和其他外设也有更新：新增了 USB MIDI 2.0 设备驱动，支持 Cirrus Logic CS42L43 音频编解码器，以及多种新型外设（例如游戏手柄、键盘背光、LED 灯条等）的支持。

GPU 驱动：AMD 图形驱动支持 Zen5 平台传感器与 EDAC，新增 Dynamic Boost 控制；支持 FreeSync Panel Replay 技术；NVIDIA 驱动为 T4 GPU 添加了次总线复位支持。同时，Mesa/Nouveau 驱动增加了针对 NVK Vulkan 的新 uAPI。

网络设备：新增多款 Mellanox/NVIDIA 网卡支持，以及新的设备树绑定；引入新的 IIO 传感器驱动和 Intel IVSC MEI 驱动，完善对服务器平台的硬件监控和管理。

存储控制器：支持分区（Zoned）块设备的用户态驱动 ublk；新增对最新 NVMe/SCSI 控制器及其特性的支持；完善文件系统层与硬件交互的性能和稳定性。

其他外设：新增 USB MIDI 2.0 Gadget 驱动、Cirrus Logic CS42L43 音频驱动、Group Multi-Color (GMC) LED 灯带驱动、GameSir T4 Kaleid 控制器驱动等；增强了对 Chromebook (MediaTek SoC) 等平台的显示和散热管理支持。

架构支持

在多种 CPU 平台上，Linux 6.6 也做了新的兼容性和优化工作。RISC-V 架构引入了内核地址空间布局随机化（KASLR）和 BPF 程序打包分配器支持，大大提升安全性。PA-RISC 架构新增了本地 eBPF JIT 编译器，使 BPF 程序在该平台上也能高效运行。LoongArch 平台新增对 KASAN/KFENCE/KCOV/KDB 等调试和检测工具的支持，便于开发者在该架构上发现内核问题。此外，还有部分常见平台的改进：在 Arm 平台上，为某些异构（big.LITTLE）系统重新引入了核簇调度支持；PowerPC 增加了热插拔 SMT 功能；AMD EPYC/Zen 处理器得到更多机能特性支持（如硬件电源事件 LM）等。

RISC-V：新增内核 KASLR 和 Control-Flow Integrity 支持；引入 BPF 程序打包分配器；实现了更丰富的用户空间性能计数器访问。

PA-RISC：添加了本地 eBPF JIT 编译器，使该架构能加速运行 BPF 程序。

LoongArch：新增对 KASAN、KFENCE、KCOV、KGDB 等调试和安全检测工具的支持。

x86/AMD：重新引入了对于混合核（hybrid CPU）的簇级调度策略；支持最新 Sapphire Rapids 处理器的 PECI 功能；AMD Zen/EPYC 新增温度和错误检测支持。

其他：支持部分 ARM 体系结构的特定 SoC 功能，如 MediaTek 显示接口优化；PowerPC 平台获得了热插拔 SMT 的支持；增加了 Apple M 系列等平台上现有特性的兼容性改进。

BPF/eBPF 特性

Linux 6.6 对 BPF 子系统进行了一系列增强，扩展了 BPF 程序的功能和可移植性。网络相关方面，为 TC (Traffic Control) 链路添加了对 SO_REUSEPORT 的支持，可更灵活地将套接字与 BPF 程序绑定；同时实现了基于文件描述符的新型 TC BPF 附加 API（TCX），并在 bpftool 中增加了对 TCX 链接的展示支持。BPF 程序的新功能包括：新增多重 uprobes 链接支持（multi uprobe link），可同时追踪多个相同函数实例；增加 bpf_get_func_ip 等 helper 以在 uprobes 中获取被跟踪函数地址；支持 Kprobe 多实例和 perf_event 链接的 fill_link_info 回调；引入新的 CPU 指令集版本支持，可使用更新版本的寄存器指令集。在 BPF 映射和工具方面，为每个 CPU 统计 BPF map 访问次数；libbpf 新增了 netfilter 链接附加帮助函数；对 BPF 引擎内部数据结构进行了安全改进，如为共享拥有场景下的 BPF 节点添加所有者字段。此外，还去除了旧的 BPF 事件子系统支持（将其标记为过时），并继续改进了 verifier 的可靠性。总之，6.6 版在 BPF 跟踪和网络功能上提供了更丰富的 API 和工具支持，使得 eBPF 在监控和网络编程中的灵活性大幅提升。

TC (Traffic Control) 与 BPF 链接：增加了 SO_REUSEPORT 支持以优化 TC BPF 程序分流；实现了基于文件描述符的新 TC attach API (TCX) 并在 bpftool 中支持查看 TCX 链接。

Uprobe/Kprobe：支持多重 uprobes 链接，可同时追踪同一函数的多个实例；新增 helper bpf_get_func_ip 方便获取被跟踪函数地址；完善了 Kprobe 多实例和 Perf 事件链路的链接信息回填。

指令集与映射：支持新的 CPU v4 版本指令集，可在 BPF 程序中使用更多寄存器命令；为 BPF 映射增加了每 CPU 访问统计字段。

Libbpf 与工具：libbpf 增加了对 netfilter 链接附加的帮助接口；bpftool 现支持显示 TCX 和 XDP 链接；内核 BPF 子系统新增 owner 字段用于 BPF 节点的安全验证。

其他：移除不再使用的 BPF 事件支持子系统；在 PA-RISC 架构上首次加入了 JIT 编译器，以原生方式执行 eBPF 程序。

其他模块更新

除上述主要方面之外，Linux 6.6 在跟踪/调试、虚拟化和内核 API 等模块也带来了显著变化。跟踪子系统引入了 eventfs（事件文件系统），以动态方式分配追踪点所需的 inode 和 dentry，显著降低了关闭追踪时对内存的占用。新增了 fchmodat2() 系统调用（在原有 fchmodat() 基础上增加 AT_SYMLINK_NOFOLLOW 功能），增强了符号链接安全操作的灵活性。在虚拟化领域，6.6 继续增强 KVM 功能：支持 PowerPC 的热插拔 SMT 并完善了 KVM 特性，同时 Hyper-V 平台上增加了对 SEV-SNP 和 TDX 客户机的支持。IO 子系统方面，增加了对网络设备的 io_uring 支持和 ublk 用户态块驱动对分区存储（Zoned）设备的支持。调试与工具层面，如 KASAN、KFENCE、KGDB 等调试设施在更多平台（如 LoongArch）上得到支持。总体而言，这些更新提高了内核的可维护性和新平台的适应性。

跟踪/调试：引入 eventfs，通过按需分配 inode 来降低 tracefs 的内存占用；增强了跟踪过滤与 BTF 对探测事件的支持。增加了 fchmodat2() 系统调用，支持对符号链接进行不跟踪 (no-follow) 的 chmod 操作。

虚拟化：PowerPC 支持热插拔 SMT；新增 Hyper-V 上 SEV-SNP 和 TDX 客户机支持；KVM 持续集成了 ARM64 的 NV 转发基础设施等虚拟化功能。

内核 API：挂载系统调用 (mount()) 新增防止共享超级块的标志；zswap 支持多个 zpool；TMPFS 新增配额、直接 I/O 和扩展属性支持。

调试/安全工具：LoongArch 平台对 KASAN/KFENCE/KCOV/KDB 等工具的支持；Intel RAPL 功率管理功能改进；持续扩展对 Kconfig 和 config 选项的清理和增强。

**参考文献：**如上文所示，各部分内容引用了官方内核发布说明、KernelNewbies 编译日志、Phoronix 和 9to5Linux 等技术报道。例如 EEVDF 调度器和 I/O 优化的细节来自 KernelNewbies 的 6.6 特性汇总；文件系统和 BPF 更新则参考了 9to5Linux 和 Phoronix 等社区资料；安全增强和驱动支持信息源自 Collabora 博客和内核补丁说明等权威渠道。所有引用均标注于相应段落。