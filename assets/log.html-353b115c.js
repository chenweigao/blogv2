import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as t,f as s}from"./app-22cda79c.js";const e={},o=s(`<h1 id="logging" tabindex="-1"><a class="header-anchor" href="#logging" aria-hidden="true">#</a> logging</h1><h2 id="abstract" tabindex="-1"><a class="header-anchor" href="#abstract" aria-hidden="true">#</a> Abstract</h2><p>Python 自带了 <code>logging</code> 模块，可以很方便我们进行日志打印。本文章主要总结几个使用该模块的时候需要注意的问题和实战示例。</p><p>其基本的使用方法如下：</p><div class="language-python" data-ext="py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> logging
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&#39;Watch out!&#39;</span><span class="token punctuation">)</span>
WARNING<span class="token punctuation">:</span>root<span class="token punctuation">:</span>Watch out!
</code></pre></div><h2 id="log-level" tabindex="-1"><a class="header-anchor" href="#log-level" aria-hidden="true">#</a> Log level</h2><p>Python 的日志可以分为几个级别：</p><table><thead><tr><th>Task</th><th>Level for task</th><th></th></tr></thead><tbody><tr><td>console 级别</td><td><code>print()</code></td><td></td></tr><tr><td>events that occur during normal operation of a program</td><td><code>logging.info()</code> or <code>logging.debug()</code></td><td></td></tr><tr><td>Issue a warning regarding a particular runtime event</td><td><code>logging.warn()</code></td><td></td></tr><tr><td>Report an error</td><td>Raise Exception</td><td></td></tr><tr><td>Report suppression of an error without raising an exception</td><td><code>logging.error()</code> or <code>logging.exception</code> or <code>logging.critical()</code></td><td></td></tr></tbody></table><p>The logging functions are named after the level or severity of the events they are used to track. The standard levels and their applicability are described below (in increasing order of severity):</p><table><thead><tr><th style="text-align:left;">Level</th><th style="text-align:left;">When it’s used</th></tr></thead><tbody><tr><td style="text-align:left;"><code>DEBUG</code></td><td style="text-align:left;">Detailed information, typically of interest only when diagnosing problems.</td></tr><tr><td style="text-align:left;"><code>INFO</code></td><td style="text-align:left;">Confirmation that things are working as expected.</td></tr><tr><td style="text-align:left;"><code>WARNING</code></td><td style="text-align:left;">An indication that something unexpected happened, or indicative of some problem in the near future (e.g. ‘disk space low’). The software is still working as expected.</td></tr><tr><td style="text-align:left;"><code>ERROR</code></td><td style="text-align:left;">Due to a more serious problem, the software has not been able to perform some function.</td></tr><tr><td style="text-align:left;"><code>CRITICAL</code></td><td style="text-align:left;">A serious error, indicating that the program itself may be unable to continue running.</td></tr></tbody></table><p>The default level is <code>WARNING</code>, which means that only events of this level and above will be tracked, unless the logging package is configured to do otherwise.</p><p>​</p><h2 id="logging-to-a-file" tabindex="-1"><a class="header-anchor" href="#logging-to-a-file" aria-hidden="true">#</a> Logging to a file</h2><h3 id="to-file" tabindex="-1"><a class="header-anchor" href="#to-file" aria-hidden="true">#</a> to file</h3><p>如果我们想将日志打印到文件中，则需要进行日志的配置，配置的方法如下：</p><div class="language-python" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> logging
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>filename<span class="token operator">=</span><span class="token string">&#39;example.log&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">,</span> level<span class="token operator">=</span>logging<span class="token punctuation">.</span>DEBUG<span class="token punctuation">)</span>
</code></pre></div><p>注意到这个配置只需要配置一次就全局生效了，具体来说，只有第一的调用是生效了的。</p><h3 id="to-console" tabindex="-1"><a class="header-anchor" href="#to-console" aria-hidden="true">#</a> to console</h3><p>如果我们想打印到控制台的话，可以使用如下的配置：</p><div class="language-python" data-ext="py"><pre class="language-python"><code>logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>stream<span class="token operator">=</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
</code></pre></div><div class="hint-container tip"><p class="hint-container-title">💚💚💚在命令行中指令日志的打印级别</p><p>可以使用 <code>--log=INFO</code> 来制定日志的打印级别。</p></div><h2 id="logging-format" tabindex="-1"><a class="header-anchor" href="#logging-format" aria-hidden="true">#</a> Logging Format</h2><p>在使用 <code>logging</code> 模块的时候，遇到了要打印多个参数但是报错的问题，针对这个问题，我们使用标准的 <code>format</code> 语法，可以避免错误，如下：</p><div class="language-python" data-ext="py"><pre class="language-python"><code>logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&#39;pattern {} similar res is {}, write to file...&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>pattern_1<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>相比于 <code>%d</code> 的方式，上述的方式较新。</p><h2 id="logging-in-different-plarform" tabindex="-1"><a class="header-anchor" href="#logging-in-different-plarform" aria-hidden="true">#</a> Logging in different plarform</h2><p>我们可以同一套代码在不同的平台使用不同的日志配置，如下所示：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">if</span> platform<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&#39;Linux&#39;</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>filename<span class="token operator">=</span><span class="token string">&#39;wechat_sendmessage_st_021.log&#39;</span><span class="token punctuation">,</span> level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&#39;you are in linux, confining the linux sys config...&#39;</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>file_split <span class="token operator">=</span> <span class="token string">&#39;/srv/workspace/workcode/tmpfile/wechat_sendmessage_st_021.txt&#39;</span>
    worker_count <span class="token operator">=</span> <span class="token number">8</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>stream<span class="token operator">=</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> level<span class="token operator">=</span>logging<span class="token punctuation">.</span>DEBUG<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&#39;you are in windows, confining the windows sys config...&#39;</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>file_split <span class="token operator">=</span> <span class="token string">&#39;../../oat/trace_converted/wechat_sendmessage_st_021.txt&#39;</span>
    worker_count <span class="token operator">=</span> <span class="token number">4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码，我们在 windows 环境下面使用控制台输出，而在 Linux 下面使用文件输出。</p>`,29),p=[o];function i(l,c){return a(),t("div",null,p)}const g=n(e,[["render",i],["__file","log.html.vue"]]);export{g as default};
